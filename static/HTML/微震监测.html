<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>微震监测页面</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="/static/js/echarts.js"></script>
    <script src="/static/js/flexible.js"></script>
    <link href="/static/css/layui.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/微震监测.css"/>
</head>
<body>



<div class="box" >
    <div class="switch">
    <h1>微震监测管理页面</h1>
    <div class="layui-tab layui-tab-brief" >
      <ul class="layui-tab-title">
        <li class="layui-this" style="width: 2rem">数据采集</li>
        <li style="width: 2rem">参数设置</li>
        <li style="width: 2rem">数据分析</li>
        <li style="width: 2rem">微震定位</li>
        <li style="width: 2rem">智能预警</li>
      </ul>
      <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">内容-1</div>

        <div class="layui-tab-item">内容-2</div>
        <!--数据分析页面-->
        <div class="layui-tab-item" >
            <div id="data-analysis">
                <!--左侧微震显示页面-->
                <div class="column">
                    <div class="layui-card layui-panel" >
                    <table class="layui-hide" id="ID-table-demo-page"></table>
                    <!-- 数据类型选择 -->
                    <script type="text/html" id="TPL-select-primary">
                      {{#  var cityList = d.cityList || ["微震 1","汽笛 2","电流 3","爆破 4","噪声 5"]; }}
                      <select name="type" class="layui-border select-demo-primary" lay-ignore>
                        <option value="">初始值 -1</option>
                        {{#  layui.each(cityList, function(i, v){ }}
                        <option value="{{= v }}" {{= v === d.city ? 'selected' : '' }}>{{= v }}</option>
                        {{#  }); }}
                      </select>
                    </script>
                    <!-- 噪声状态开关 -->
                    <script type="text/html" id="ID-table-demo-templet-switch">
                      <input type="checkbox" name="noise" value="{{= d.id }}" title="有噪声|无噪声" lay-skin="switch" lay-filter="demo-templet-status" {{= d.id == 10001 ? "" : "" }}>
                    </script>
                    <!--<script type="text/html" id="waveform" >
                        <div style="width: 500px;height: 300px;" id="weizhen"></div>
                         <img src="/static/image/pexels-amar-preciado-12663429.jpg" ></img>
                    </script>-->
                    <script type="text/html" id="ID-table-demo-page-pagebar">
                    <div class="layui-btn-container">
                        <button class="layui-btn layui-btn-sm" lay-event="footerDemoBtn1">底部按钮1</button>
                        <button class="layui-btn layui-btn-sm" lay-event="footerDemoBtn2">底部按钮2</button>
                    </div>
                    </script>
                    </div>
                </div>
                <!--右侧功能页面-->
                <div class="column">
                    <h2 style="text-align: center;font-size: 0.3rem;font-weight:500; font-family:黑体;border: 1px solid rgba(0,0,0,0.2) ;padding: 0.25rem ">微震监测传感器数据波形</h2>
                    <div class="Microseismic-shape" id="sensor1"></div>
                    <div class="Microseismic-shape" id="sensor2"></div>
                    <div class="Microseismic-shape" id="sensor3"></div>
                    <div class="Microseismic-shape" id="sensor4"></div>
                    <div class="Microseismic-shape" id="sensor5"></div>
                    <div class="Microseismic-shape" id="sensor6"></div>
                </div>
            </div>
        </div>

        <div class="layui-tab-item">内容-4</div>

        <div class="layui-tab-item">内容-5</div>

      </div>
    </div>
    </div>
    <!--
    <div class="mictable"  id="data-collection"></div>
    <div class="mictable"  id="parameter-setting"></div>
    <div class="mictable"  id="data-analysis"></div>
    <div class="mictable"  id="Microseismic-location"></div>
    <div class="mictable"  id="Intelligent-early-warning"></div>
    <div class="mictable"  id="Undetermined-option"></div>
    -->

</div>

</body>
<script src="/static/js/layui.js"></script>
<script src="/static/js/jquery.js"></script>
<script>
/*function showModule(moduleId) {
  var modules1 = document.getElementsByClassName('table');
  var modules2=document.getElementsByClassName('layui-card layui-panel');

  //var table=document.getElementById('table1')
      //table.style.display='none';
  //先消除每个元素的activve类
  for (var i = 0; i < modules1.length; i++) {
    modules1[i].style.display='none';
  }
  for (var i = 0; i < modules2.length; i++) {
    modules2[i].style.display='none';
  }
  //增加点击按钮元素的active类

  document.getElementById(moduleId).style.display='block';
  console.log(document.getElementById(moduleId).className)
  // 隐藏表格区域
  console.log('showmodule已运行')//相当于print（）

  //tableContainer.style.display = 'none';
}*/

//实例化表格对象
layui.use('table', function() {
    var table = layui.table;
    // 加载table实例
    var inst = table.render({
        elem: '#ID-table-demo-page',
        url: '/static/weizhen.json', // 此处为静态模拟数据，实际使用时需换成真实接口，数据接口
        page: { // 支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
            limit: 15,
            limits: [5, 10, 15, 20],

            layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'], //自定义分页布局
            //curr: 1, //设定初始在第 5 页
            groups: 1, //只显示 1 个连续页码
            first: false, //不显示首页
            last: false //不显示尾页
        },
        pagebar: '#ID-table-demo-page-pagebar', // 分页栏模板
        css: [ // 设置单元格样式
              // 取消默认的溢出隐藏，并设置适当高度

              '.layui-table-cell select{height:100%;  margin: 0 auto;}',
              '.layui-table-cell .layui-form-switch{height:100%;  margin: 0 auto;}'
            ].join(''),
        cols: [[
            {field: 'id', width: 130, title: '传感器ID', sort: false},
            {field: 'data type', width: 133.93, title: '数据类型', sort: false,templet: '#TPL-select-primary'},
            {field: 'noise', width: 133.93, title: '是否含有噪声', sort: false,templet: '#ID-table-demo-templet-switch'},
            {field: 'p-wave arrival time', width: 133.93, title: 'P波到时', sort: false},
            {field: 's-wave arrival time', width: 133.93, title: 'S波到时', sort: false},
           // {field: 'time', width: 204.7, title: '时间', sort: false},
        ]],
        done: function(res, curr, count){
              var options = this;
              // 获取当前行数据
              table.getRowData = function(elem){
                var index = $(elem).closest('tr').data('index');
                return table.cache[options.id][index] || {};
              };

              // 原生 select 事件
              $('.select-demo-primary').on('change', function(){
                var value = this.value; // 获取选中项 value
                var data = table.getRowData(this); // 获取当前行数据(如 id 等字段，以作为数据修改的索引)
                // 更新数据中对应的字段
                data.city = value;
                // 显示 - 仅用于演示
                layer.msg('选中值: '+ value +'<br>当前行数据：'+ JSON.stringify(data));
              });


            }
        /*parseData: function(res){ //将原始数据解析成 table 组件所规定的数据，res为从url中get到的数据
	    var result;

	    //(前端来实现)分页方法一：
	    //这是前台 用res.data接受全部数据 再根据当前页的条件从全部数据中选取一部分数据显示出来
	    if(this.page.curr){
	        //若为第二页 则curr为2 页面显示的数据就是从res.data集合数组里的 （2-1）*limit（10）=10 到 limit（10）*2=20的数据
	        result = res.data.slice(this.limit*(this.page.curr-1),this.limit*this.page.curr);
	    }
	    else{
	        // 一开始就是第一页 则就是 显示的数据就是从res.data集合数组里的0到limit（10）中
	        result=res.data.slice(0,this.limit);
	    }
	     return {
	        "code": 0, //解析接口状态
	        "msg": res.msg, //解析提示文本
	        "count": res.count, //解析数据长度
	        "data": result //解析数据列表
	    };
	},*/
    });

    // 状态 - 开关操作
    form.on('switch(demo-templet-status)', function(obj){
        var id = this.value;
        var name = this.name;
        layer.tips(id + ' ' + name + ': '+ obj.elem.checked, obj.othis);
          });
    // 底部分页栏事件
    table.on('pagebar(ID-table-demo-page)', function (obj) {
        var eventValue = obj.event; // 获得按钮 lay-event 值
        layer.msg(eventValue);
    });
})
</script>
<!--echarts实例化-->
<script>
var sensors=[
    {id:'sensor1'},
    {id:'sensor2'},
    {id:'sensor3'},
    {id:'sensor4'},
    {id:'sensor5'},
    {id:'sensor6'},
];
for (var i=0; i < sensors.length; i++) {
    (function () {
        sensorid=sensors[i].id
        console.log(sensorid)
        var sensor = echarts.init(document.getElementById(sensorid));
        $.get('/static/aqi-beijing.json', function (data) {
            sensor.setOption(
                (option = {
                    backgroundColor: '#ffffcc',
                    title: {
                        show: false,
                        text: '年月日',
                        right: '1%',
                        textStyle: {
                            color: 'black',
                            fontFamily: '微软雅黑',
                            fontWeight: 'lighter',
                            fontSize: 16
                        }
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        top: '12%',
                        left: '5%',
                        right: '2%',
                        bottom: '31%',

                    },
                    xAxis: {
                        data: data.map(function (item) {
                            return item[0];
                        })
                    },
                    yAxis: {},

                    dataZoom: [
                        {
                            startValue: '2014-06-01'
                        },
                        {
                            type: 'inside'
                        }
                    ],

                    series: {
                        name: '振幅',
                        type: 'line',
                        lineStyle: {
                            color: 'red',
                        },
                        symbol: 'none',
                        data: data.map(function (item) {
                            return item[1];
                        })
                    }
                })
            );
        });
        window.addEventListener("resize", function () {//echarts自带的能随着页面大小自动变化的函数
            sensor.resize();
        });
    })();

}


</script>
</html>